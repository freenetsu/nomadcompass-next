generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String         @id @default(cuid())
  email         String         @unique
  name          String?
  googleId      String?        @unique
  image         String?
  emailVerified DateTime?
  role          String         @default("user")
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  accounts      Account[]
  favorites     Favorite[]
  sessions      Session[]
  responses     UserResponse[]

  @@map("users")
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("sessions")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}

model UserResponse {
  id        String   @id @default(cuid())
  userId    String
  responses Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_responses")
}

model Country {
  id        String       @id @default(cuid())
  name      String       @unique
  code      String       @unique
  flag      String
  continent String
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  data      CountryData?
  favorites Favorite[]

  @@map("countries")
}

model CountryData {
  id                String   @id @default(cuid())
  countryId         String   @unique
  costOfLivingIndex Float?
  averageRent       Float?
  averageSalary     Float?
  averageTemp       Float?
  climate           String?
  rainfall          Float?
  safetyIndex       Float?
  healthcareIndex   Float?
  pollutionIndex    Float?
  internetSpeed     Float?
  transportIndex    Float?
  visaRequirements  String?
  taxRate           Float?
  rawData           Json?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  country           Country  @relation(fields: [countryId], references: [id], onDelete: Cascade)

  @@map("country_data")
}

model Favorite {
  id        String   @id @default(cuid())
  userId    String
  countryId String
  createdAt DateTime @default(now())
  country   Country  @relation(fields: [countryId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, countryId])
  @@map("favorites")
}
